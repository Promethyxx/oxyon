app-id: io.github.promethyxx.Oxyon
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.rust-stable
command: oxyon
finish-args:
  - --share=ipc
  - --share=network
  - --socket=x11
  - --socket=wayland
  - --socket=fallback-x11
  - --device=dri
  - --filesystem=home
build-options:
  append-path: /usr/lib/sdk/rust-stable/bin
  env:
    CARGO_HOME: /run/build/oxyon/cargo
modules:
  - name: oxyon
    buildsystem: simple
    build-commands:
      - cargo --offline build --profile dist
      - install -Dm755 target/dist/oxyon /app/bin/oxyon
      - install -Dm644 assets/io.github.promethyxx.Oxyon.desktop /app/share/applications/io.github.promethyxx.Oxyon.desktop
      - install -Dm644 assets/io.github.promethyxx.Oxyon.metainfo.xml /app/share/metainfo/io.github.promethyxx.Oxyon.metainfo.xml
      - install -Dm644 assets/io.github.promethyxx.Oxyon.png /app/share/icons/hicolor/512x512/apps/io.github.promethyxx.Oxyon.png
    sources:
      - type: git
        url: https://github.com/Promethyxx/oxyon.git
        tag: 1.3.5
        commit: c62bc9c98dcc054e30f6aadf66e8adb2a696bd4d
      - type: file
        url: https://github.com/Promethyxx/oxyon/releases/download/assets-linux-x64/ffmpeg
        dest: bin-linux-x64
        dest-filename: ffmpeg
        sha256: 3ee15e5145c9eb4775c193ab824c592d4ff3744bb7f283f8db29bd3c3c961589
        only-arches: [x86_64]
      - type: file
        url: https://github.com/Promethyxx/oxyon/releases/download/assets-linux-x64/ffprobe
        dest: bin-linux-x64
        dest-filename: ffprobe
        sha256: 6e8f8f7babb9c4163966bf23bd230d0510dc34f19d2d20b95613fbc3d67f21cf
        only-arches: [x86_64]
      - type: file
        url: https://github.com/Promethyxx/oxyon/releases/download/assets-linux-x64/mkvpropedit
        dest: bin-linux-x64
        dest-filename: mkvpropedit
        sha256: 880d27d13f6df5cad7083368e9a2d935d7d5c42b9faa886efb70dbf7506e95bc
        only-arches: [x86_64]
      - type: file
        url: https://github.com/Promethyxx/oxyon/releases/download/assets-linux-x64/pandoc
        dest: bin-linux-x64
        dest-filename: pandoc
        sha256: decd3dd11a3fe0c16ce56443343ec53adde6fbed6f97d7f56f06b1c424248e7b
        only-arches: [x86_64]
      - type: file
        url: https://github.com/Promethyxx/oxyon/releases/download/assets-linux-arm/ffmpeg
        dest: bin-linux-arm
        dest-filename: ffmpeg
        sha256: c525cf56c432cecb1deef8c75f913f9cd6825492072bbb34e8f7c3c9495508fb
        only-arches: [aarch64]
      - type: file
        url: https://github.com/Promethyxx/oxyon/releases/download/assets-linux-arm/ffprobe
        dest: bin-linux-arm
        dest-filename: ffprobe
        sha256: 40b8b7c9036e485ce7609a846c7bf71a59b554b8152cf486c366600067603633
        only-arches: [aarch64]
      - type: file
        url: https://github.com/Promethyxx/oxyon/releases/download/assets-linux-arm/mkvpropedit
        dest: bin-linux-arm
        dest-filename: mkvpropedit
        sha256: c2b626f383212c19a43366d7645f25d70e0d16a158d49edaa1ad00fe4f933fb9
        only-arches: [aarch64]
      - type: file
        url: https://github.com/Promethyxx/oxyon/releases/download/assets-linux-arm/pandoc
        dest: bin-linux-arm
        dest-filename: pandoc
        sha256: 14ef98d698633b7e8a135cad59f5ffe60d00e9519a0a515b8040ea0cdbd69ea9
        only-arches: [aarch64]
      - cargo-sources.json
